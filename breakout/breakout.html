<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Breakout</title>
    <style>
        * { padding: 0; margin: 0; }
        canvas { background: #eee; display: block; margin: 0 auto; }
    </style>
</head>
<body>

<canvas id="playground" width="480" height="320"></canvas>

<script>
    // JavaScript code goes here
    var canvas = document.getElementById("playground");
    var ctx = canvas.getContext("2d");
    var points = 0;

    var x = canvas.width/2;
    var y = canvas.height - 30;
    var dx = 2;
    var dy = -2;
    var ballRadius = 10;

    var padWidth = 100;
    var padHeight = 10;
    var padX = canvas.width/2 - padWidth;
    var padY = canvas.height-10;
    
    // pad controls
    var rightPressed = false;
    var leftPressed = false;

    // bricks
    var brickRowCount = 3;
    var brickColumnCount = 5;
    var brickWidth = 75;
    var brickHeight = 20;
    var brickPadding = 10;
    var brickOffsetTop = 30;
    var brickOffsetLeft = 30;

    // init bricks

    var bricks = [];
    for(col = 0; col < brickColumnCount; col++) {
        bricks[col] = [];
        for(row = 0; row < brickRowCount; row++) {
            bricks[col][row] = { x: 0, y: 0, status: 1 };
        }
    }


    document.addEventListener("keydown", keyDownHandler, false);
    document.addEventListener("keyup", keyUpHandler, false);

    function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        drawBricks();
        drawBall();
        drawPad();
        updateBallPosition();
        updatePadPosition();
        collisionDetection();
    }

    function drawBall() {
        ctx.beginPath();
        ctx.arc(x, y, ballRadius, 0, 2*Math.PI);
        ctx.fillStyle = "#0095DD";
        ctx.fill();
        ctx.closePath();
    }

    function drawPad() {
        ctx.beginPath();
        ctx.rect(padX, padY, padWidth, padHeight);
        ctx.fillStyle = "#0095DD";
        ctx.fill();
        ctx.closePath();
    }

    function drawBricks() {
        for(col = 0; col < brickColumnCount; col++) {
            for(row = 0; row < brickRowCount; row++) {
                if (bricks[col][row].status == 1) {
                    var brickX = (col*(brickWidth+brickPadding))+brickOffsetLeft;
                    var brickY = (row*(brickHeight+brickPadding))+brickOffsetTop;
                    bricks[col][row].x = brickX;
                    bricks[col][row].y = brickY;
                   
                    ctx.beginPath();
                    ctx.rect(brickX, brickY, brickWidth, brickHeight);
                    ctx.fillStyle = "#0095DD";
                    ctx.fill();
                    ctx.closePath();
                } else {
                    bricks[col][row] = {};
                }
            }
        }
    }

    function updateBallPosition() {
        if(y + dy < ballRadius) {
             dy = -dy;
        } else if(y + dy > canvas.height-ballRadius) {
            if(x > padX && x < padX + padWidth) {
                dy = -dy;
                points++;
               // console.log(points);
            } else {
                 dy = -dy;
               // console.log("GAME OVER");
                
            }
        }

        if (x + dx <= ballRadius || x + dx >= canvas.width - ballRadius) {
            dx = -dx;
        }

        x += dx;
        y += dy;
    }

    function updatePadPosition() {
        if (leftPressed) {
            padX = padX - 3 >= 0 ? padX - 3 : 0;
        } else if (rightPressed) {
            padX = padX + 3 +padWidth <= canvas.width ? padX + 3 : padX;
        }
    }

    function collisionDetection() {
        for(col = 0; col < brickColumnCount; col++) {
            for(row = 0; row < brickRowCount; row++) {
                var brick = bricks[col][row];
                if(x > brick.x && x < brick.x+brickWidth && y == brick.y && y < brick.y+brickHeight) {
                    dy = -dy;
                    brick.status = 0;
                }
            }
        }
    }

    function keyDownHandler(key) {
        if(key.keyCode == 39) {
            rightPressed = true;
        }
        else if(key.keyCode == 37) {
            leftPressed = true;
        }
    }

    function keyUpHandler(key) {
        if(key.keyCode == 39) {
            rightPressed = false;
        }
        else if(key.keyCode == 37) {
            leftPressed = false;
        }
    }

    setInterval(draw, 10);
</script>

</body>
</html>